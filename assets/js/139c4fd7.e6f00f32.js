"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9994],{35318:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return f}});var a=n(27378);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),m=u(n),d=r,f=m["".concat(s,".").concat(d)]||m[d]||c[d]||l;return n?a.createElement(f,o(o({ref:t},p),{},{components:n})):a.createElement(f,o({ref:t},p))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var l=n.length,o=new Array(l);o[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[m]="string"==typeof e?e:r,o[1]=i;for(var u=2;u<l;u++)o[u]=n[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},39798:function(e,t,n){n.d(t,{Z:function(){return o}});var a=n(27378),r=n(38944),l="tabItem_wHwb";function o(e){var t=e.children,n=e.hidden,o=e.className;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(l,o),hidden:n},t)}},23930:function(e,t,n){n.d(t,{Z:function(){return w}});var a=n(25773),r=n(27378),l=n(38944),o=n(83457),i=n(3620),s=n(30654),u=n(70784),p=n(71819);function m(e){return function(e){return r.Children.map(e,(function(e){if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')}))}(e).map((function(e){var t=e.props;return{value:t.value,label:t.label,attributes:t.attributes,default:t.default}}))}function c(e){var t=e.values,n=e.children;return(0,r.useMemo)((function(){var e=null!=t?t:m(n);return function(e){var t=(0,u.l)(e,(function(e,t){return e.value===t.value}));if(t.length>0)throw new Error('Docusaurus error: Duplicate values "'+t.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e}),[t,n])}function d(e){var t=e.value;return e.tabValues.some((function(e){return e.value===t}))}function f(e){var t=e.queryString,n=void 0!==t&&t,a=e.groupId,l=(0,i.k6)(),o=function(e){var t=e.queryString,n=void 0!==t&&t,a=e.groupId;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=a?a:null}({queryString:n,groupId:a});return[(0,s._X)(o),(0,r.useCallback)((function(e){if(o){var t=new URLSearchParams(l.location.search);t.set(o,e),l.replace(Object.assign({},l.location,{search:t.toString()}))}}),[o,l])]}function b(e){var t,n,a,l,o=e.defaultValue,i=e.queryString,s=void 0!==i&&i,u=e.groupId,m=c(e),b=(0,r.useState)((function(){return function(e){var t,n=e.defaultValue,a=e.tabValues;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!d({value:n,tabValues:a}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+a.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}var r=null!=(t=a.find((function(e){return e.default})))?t:a[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:o,tabValues:m})})),g=b[0],h=b[1],v=f({queryString:s,groupId:u}),k=v[0],y=v[1],N=(t=function(e){return e?"docusaurus.tab."+e:null}({groupId:u}.groupId),n=(0,p.Nk)(t),a=n[0],l=n[1],[a,(0,r.useCallback)((function(e){t&&l.set(e)}),[t,l])]),w=N[0],x=N[1],S=function(){var e=null!=k?k:w;return d({value:e,tabValues:m})?e:null}();return(0,r.useLayoutEffect)((function(){S&&h(S)}),[S]),{selectedValue:g,selectValue:(0,r.useCallback)((function(e){if(!d({value:e,tabValues:m}))throw new Error("Can't select invalid tab value="+e);h(e),y(e),x(e)}),[y,x,m]),tabValues:m}}var g=n(76457),h="tabList_J5MA",v="tabItem_l0OV";function k(e){var t=e.className,n=e.block,i=e.selectedValue,s=e.selectValue,u=e.tabValues,p=[],m=(0,o.o5)().blockElementScrollPositionUntilNextRender,c=function(e){var t=e.currentTarget,n=p.indexOf(t),a=u[n].value;a!==i&&(m(t),s(a))},d=function(e){var t,n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":var a,r=p.indexOf(e.currentTarget)+1;n=null!=(a=p[r])?a:p[0];break;case"ArrowLeft":var l,o=p.indexOf(e.currentTarget)-1;n=null!=(l=p[o])?l:p[p.length-1]}null==(t=n)||t.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":n},t)},u.map((function(e){var t=e.value,n=e.label,o=e.attributes;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:function(e){return p.push(e)},onKeyDown:d,onClick:c},o,{className:(0,l.Z)("tabs__item",v,null==o?void 0:o.className,{"tabs__item--active":i===t})}),null!=n?n:t)})))}function y(e){var t=e.lazy,n=e.children,a=e.selectedValue;if(n=Array.isArray(n)?n:[n],t){var l=n.find((function(e){return e.props.value===a}));return l?(0,r.cloneElement)(l,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},n.map((function(e,t){return(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a})})))}function N(e){var t=b(e);return r.createElement("div",{className:(0,l.Z)("tabs-container",h)},r.createElement(k,(0,a.Z)({},e,t)),r.createElement(y,(0,a.Z)({},e,t)))}function w(e){var t=(0,g.Z)();return r.createElement(N,(0,a.Z)({key:String(t)},e))}},1801:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return p},default:function(){return b},frontMatter:function(){return u},metadata:function(){return m},toc:function(){return d}});var a=n(25773),r=n(30808),l=(n(27378),n(35318)),o=n(23930),i=n(39798),s=["components"],u={id:"babel-plugin-transform-modules-umd",title:"@babel/plugin-transform-modules-umd",sidebar_label:"UMD"},p=void 0,m={unversionedId:"babel-plugin-transform-modules-umd",id:"babel-plugin-transform-modules-umd",title:"@babel/plugin-transform-modules-umd",description:"History",source:"@site/../docs/plugin-transform-modules-umd.md",sourceDirName:".",slug:"/babel-plugin-transform-modules-umd",permalink:"/babel-website/docs/babel-plugin-transform-modules-umd",draft:!1,editUrl:"https://github.com/babel/website/edit/main/docs/../docs/plugin-transform-modules-umd.md",tags:[],version:"current",frontMatter:{id:"babel-plugin-transform-modules-umd",title:"@babel/plugin-transform-modules-umd",sidebar_label:"UMD"},sidebar:"plugins",previous:{title:"SystemJS",permalink:"/babel-website/docs/babel-plugin-transform-modules-systemjs"},next:{title:"async-do-expressions",permalink:"/babel-website/docs/babel-plugin-proposal-async-do-expressions"}},c={},d=[{value:"Example",id:"example",level:2},{value:"Installation",id:"installation",level:2},{value:"Usage",id:"usage",level:2},{value:"With a configuration file (Recommended)",id:"with-a-configuration-file-recommended",level:3},{value:"Default semantics",id:"default-semantics",level:4},{value:"More flexible semantics with <code>exactGlobals: true</code>",id:"more-flexible-semantics-with-exactglobals-true",level:4},{value:"Via CLI",id:"via-cli",level:3},{value:"Via Node API",id:"via-node-api",level:3},{value:"Options",id:"options",level:3}],f={toc:d};function b(e){var t=e.components,n=(0,r.Z)(e,s);return(0,l.kt)("wrapper",(0,a.Z)({},f,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("details",null,(0,l.kt)("summary",null,"History"),(0,l.kt)("table",null,(0,l.kt)("thead",{parentName:"table"},(0,l.kt)("tr",{parentName:"thead"},(0,l.kt)("th",{parentName:"tr",align:null},"Version"),(0,l.kt)("th",{parentName:"tr",align:null},"Changes"))),(0,l.kt)("tbody",{parentName:"table"},(0,l.kt)("tr",{parentName:"tbody"},(0,l.kt)("td",{parentName:"tr",align:null},(0,l.kt)("inlineCode",{parentName:"td"},"v7.14.0")),(0,l.kt)("td",{parentName:"tr",align:null},"Implemented the ",(0,l.kt)("inlineCode",{parentName:"td"},"importInterop")," option"))))),(0,l.kt)("blockquote",null,(0,l.kt)("p",{parentName:"blockquote"},(0,l.kt)("strong",{parentName:"p"},"NOTE"),": This plugin is included in ",(0,l.kt)("inlineCode",{parentName:"p"},"@babel/preset-env")," under the ",(0,l.kt)("inlineCode",{parentName:"p"},"modules")," option")),(0,l.kt)("p",null,"This plugin transforms ES2015 modules to ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/umdjs/umd"},"UMD"),". Note that only the ",(0,l.kt)("em",{parentName:"p"},"syntax")," of import/export statements (",(0,l.kt)("inlineCode",{parentName:"p"},'import "./mod.js"'),") is transformed, as Babel is unaware of different resolution algorithms between implementations of ES2015 modules and UMD."),(0,l.kt)("p",null,"\u26a0\ufe0f This plugin does not support dynamic import (",(0,l.kt)("inlineCode",{parentName:"p"},"import('./lazy.js')"),")."),(0,l.kt)("h2",{id:"example"},"Example"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"In")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="JavaScript"',title:'"JavaScript"'},"export default 42;\n")),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"Out")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="JavaScript"',title:'"JavaScript"'},'(function(global, factory) {\n  if (typeof define === "function" && define.amd) {\n    define(["exports"], factory);\n  } else if (typeof exports !== "undefined") {\n    factory(exports);\n  } else {\n    var mod = {\n      exports: {},\n    };\n    factory(mod.exports);\n    global.actual = mod.exports;\n  }\n})(this, function(exports) {\n  "use strict";\n\n  Object.defineProperty(exports, "__esModule", {\n    value: true,\n  });\n\n  exports.default = 42;\n});\n')),(0,l.kt)("h2",{id:"installation"},"Installation"),(0,l.kt)(o.Z,{groupId:"npm2yarn",mdxType:"Tabs"},(0,l.kt)(i.Z,{value:"npm",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"npm install --save-dev @babel/plugin-transform-modules-umd\n"))),(0,l.kt)(i.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"yarn add --dev @babel/plugin-transform-modules-umd\n")))),(0,l.kt)("h2",{id:"usage"},"Usage"),(0,l.kt)("h3",{id:"with-a-configuration-file-recommended"},"With a configuration file (Recommended)"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="babel.config.json"',title:'"babel.config.json"'},'{\n  "plugins": ["@babel/plugin-transform-modules-umd"]\n}\n')),(0,l.kt)("p",null,"You can also override the names of particular libraries when this module is\nrunning in the browser. For example the ",(0,l.kt)("inlineCode",{parentName:"p"},"es6-promise")," library exposes itself\nas ",(0,l.kt)("inlineCode",{parentName:"p"},"global.Promise")," rather than ",(0,l.kt)("inlineCode",{parentName:"p"},"global.es6Promise"),". This can be accommodated by:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="babel.config.json"',title:'"babel.config.json"'},'{\n  "plugins": [\n    [\n      "@babel/plugin-transform-modules-umd",\n      {\n        "globals": {\n          "es6-promise": "Promise"\n        }\n      }\n    ]\n  ]\n}\n')),(0,l.kt)("h4",{id:"default-semantics"},"Default semantics"),(0,l.kt)("p",null,"There are a few things to note about the default semantics."),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"First"),", this transform uses the\n",(0,l.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Basename"},"basename")," of each import to generate\nthe global names in the UMD output. This means that if you're importing\nmultiple modules with the same basename, like:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="JavaScript"',title:'"JavaScript"'},'import fooBar1 from "foo-bar";\nimport fooBar2 from "./mylib/foo-bar";\n')),(0,l.kt)("p",null,"it will transpile into two references to the same browser global:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="JavaScript"',title:'"JavaScript"'},"factory(global.fooBar, global.fooBar);\n")),(0,l.kt)("p",null,"If you set the plugin options to:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="JSON"',title:'"JSON"'},'{\n  "globals": {\n    "foo-bar": "fooBAR",\n    "./mylib/foo-bar": "mylib.fooBar"\n  }\n}\n')),(0,l.kt)("p",null,"it will still transpile both to one browser global:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="JavaScript"',title:'"JavaScript"'},"factory(global.fooBAR, global.fooBAR);\n")),(0,l.kt)("p",null,"because again the transform is only using the basename of the import."),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"Second"),", the specified override will still be passed to the ",(0,l.kt)("inlineCode",{parentName:"p"},"toIdentifier"),"\nfunction in ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/babel/babel/blob/main/packages/babel-types/src/converters"},"babel-types/src/converters"),".\nThis means that if you specify an override as a member expression like:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="JSON"',title:'"JSON"'},'{\n  "globals": {\n    "fizzbuzz": "fizz.buzz"\n  }\n}\n')),(0,l.kt)("p",null,"this will ",(0,l.kt)("em",{parentName:"p"},"not")," transpile to ",(0,l.kt)("inlineCode",{parentName:"p"},"factory(global.fizz.buzz)"),". Instead, it will\ntranspile to ",(0,l.kt)("inlineCode",{parentName:"p"},"factory(global.fizzBuzz)")," based on the logic in ",(0,l.kt)("inlineCode",{parentName:"p"},"toIdentifier"),"."),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"Third"),", you cannot override the exported global name."),(0,l.kt)("h4",{id:"more-flexible-semantics-with-exactglobals-true"},"More flexible semantics with ",(0,l.kt)("inlineCode",{parentName:"h4"},"exactGlobals: true")),(0,l.kt)("p",null,"All of these behaviors can limit the flexibility of the ",(0,l.kt)("inlineCode",{parentName:"p"},"globals")," map. To\nremove these limitations, you can set the ",(0,l.kt)("inlineCode",{parentName:"p"},"exactGlobals")," option to ",(0,l.kt)("inlineCode",{parentName:"p"},"true"),".\nDoing this instructs the plugin to:"),(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"always use the full import string instead of the basename when generating\nthe global names"),(0,l.kt)("li",{parentName:"ol"},"skip passing ",(0,l.kt)("inlineCode",{parentName:"li"},"globals")," overrides to the ",(0,l.kt)("inlineCode",{parentName:"li"},"toIdentifier")," function. Instead,\nthey are used exactly as written, so you will get errors if you do not use\nvalid identifiers or valid uncomputed (dot) member expressions."),(0,l.kt)("li",{parentName:"ol"},"allow the exported global name to be overridden via the ",(0,l.kt)("inlineCode",{parentName:"li"},"globals")," map. Any\noverride must again be a valid identifier or valid member expression.")),(0,l.kt)("p",null,"Thus, if you set ",(0,l.kt)("inlineCode",{parentName:"p"},"exactGlobals")," to ",(0,l.kt)("inlineCode",{parentName:"p"},"true")," and do not pass any overrides, the\nfirst example of:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="JavaScript"',title:'"JavaScript"'},'import fooBar1 from "foo-bar";\nimport fooBar2 from "./mylib/foo-bar";\n')),(0,l.kt)("p",null,"will transpile to:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="JavaScript"',title:'"JavaScript"'},"factory(global.fooBar, global.mylibFooBar);\n")),(0,l.kt)("p",null,"And if you set the plugin options to:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="JSON"',title:'"JSON"'},'{\n  "globals": {\n    "foo-bar": "fooBAR",\n    "./mylib/foo-bar": "mylib.fooBar"\n  },\n  "exactGlobals": true\n}\n')),(0,l.kt)("p",null,"then it'll transpile to:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="JavaScript"',title:'"JavaScript"'},"factory(global.fooBAR, global.mylib.fooBar);\n")),(0,l.kt)("p",null,"Finally, with the plugin options set to:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="babel.config.json"',title:'"babel.config.json"'},'{\n  "plugins": [\n    "@babel/plugin-external-helpers",\n    [\n      "@babel/plugin-transform-modules-umd",\n      {\n        "globals": {\n          "my/custom/module/name": "My.Custom.Module.Name"\n        },\n        "exactGlobals": true\n      }\n    ]\n  ],\n  "moduleId": "my/custom/module/name"\n}\n')),(0,l.kt)("p",null,"it will transpile to:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="JavaScript"',title:'"JavaScript"'},"factory(mod.exports);\nglobal.My = global.My || {};\nglobal.My.Custom = global.My.Custom || {};\nglobal.My.Custom.Module = global.My.Custom.Module || {};\nglobal.My.Custom.Module.Name = mod.exports;\n")),(0,l.kt)("h3",{id:"via-cli"},"Via CLI"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sh",metastring:'title="Shell"',title:'"Shell"'},"babel --plugins @babel/plugin-transform-modules-umd script.js\n")),(0,l.kt)("h3",{id:"via-node-api"},"Via Node API"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="JavaScript"',title:'"JavaScript"'},'require("@babel/core").transformSync("code", {\n  plugins: ["@babel/plugin-transform-modules-umd"],\n});\n')),(0,l.kt)("h3",{id:"options"},"Options"),(0,l.kt)("p",null,"See options for ",(0,l.kt)("a",{parentName:"p",href:"https://babeljs.io/docs/en/babel-plugin-transform-modules-commonjs#options"},(0,l.kt)("inlineCode",{parentName:"a"},"@babel/plugin-transform-modules-commonjs")),"."))}b.isMDXComponent=!0}}]);